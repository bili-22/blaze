# Blaze 包
- Blaze协议是战地系列游戏与EA之间通信所采用的一种编码方式
- 一个Blaze数据包有16字节的Header与不定长的Payload
- 当数据包的大小超过16kb时，它将被拆分为多个16kb的片段
## Header

| Size1 | Size2 | Component | Command | | ID | Type | |
|:--------------:|:--------:|:-------:|:--------:|:----:|:--------:|:----:|:--------:|
| 000f6fc3 | 0000 | 0004 | 0067 | 00 | 0002 | 20 | 0000
### Size 长度
内容部分的大小以字节为单位，正常情况下使用Size1；当出现错误（type 0x60）时，使用Size2。可以通过简单地将Size1与Size2相加来计算总大小。
### Component 组件
与Command共同构成方法名。
### Command 指令
与Component共同构成方法名。
### Id 编号
自增编号（id），该部分将会被原样返回。
### Type 包类型

| Command | Result | Message | Error | Ping | Pong |
|:----------------:|:----------:|:--------------:|:-------:|:-------:|:-----:|
| 0x00 | 0x20 | 0x40 | 0x60 | 0x80 | 0xA0 |

## Payload
- Payload是一个结构体（Struct），包含多个数据块。
### 数据类型
| Type | 类型 | 描述 |
|:-------:|:-------:|:--------|
| 0x00 | Integer | 整数
| 0x01 | String | 字符串
| 0x02 | Blob | 二进制
| 0x03 | Struct | 结构体
| 0x04 | List | 列表
| 0x05 | Map | 键值对
| 0x06 | Union | 联合体
| 0x07 | IntList | 整数列表
| 0x08 | ObjectType | 类型定义
| 0x09 | ObjectId | 类型实体
| 0x0A | Float | 浮点数
### Tag的读取
- Tag是1-4个大写字母或数字
0. 三个字节的TAG  
**HEX** D2 5C F4
1. 展开  
**BIN** 11010010 01011100 11110100
2. 分成四个六位  
**HEX** 110100 100101 110011 110100  
作为四个字节  
**BIN** 00110100 00100101 00110011 00110100
3. 将每个字节加32(100000)  
**BIN** 01010100 01000101 01010011 01010100  
**HEX** 54 45 53 54
4. 转换为四个ASCII字符  
TEST
### Integer 不定长整数
每个字节的第一位表示是否继续读取，将所有字节的后7位连起来，组成一个有符号整数（Little Endian）。
### String 字符串
字符串数据由两部分组成：第一部分是一个整数（Integer，0x00），第二部分是一个长度等于该整数值的字符串。
### Blob 二进制
Blob数据与String相似，也由两部分组成：第一部分是一个整数（Integer，0x00），第二部分是一个长度等于该整数值的二进制数据。
### Struct 结构体
结构体包含若干个数据块，每个数据块有唯一的标签（Tag），数据块的前三个字节是Tag，第四个字节是类型（Type），决定存储的数据长度与解析方式，Payload部分就是一个Struct。
### List 列表
List 数据包含多个相同类型的数据项。  
List 数据的第一个字节是 Type，表示存储的数据类型。之后是一个 Integer 类型的值，表示列表中包含的数据项的个数。最后是列表中的数据项。
### Map 键值对
Map 数据包含多个键值对，每个键值对包含一个键和一个值。Map 数据的前两个字节分别表示键和值的类型。之后是一个 Integer 类型的值，表示 Map 中包含的键值对的个数。接下来是按照键-值键-值的结构排列的数据项。
### Union 联合体
### IntList 整数列表
开头是一个Integer，后面是和开头的Int值相等数量的Int
### ObjectType 类型定义
包含两个Integer，第一个是ComponentId，第二个是TypeId
### ObjectId 类型实体
包含三个Integer，第一个是ComponentId，第二个是TypeId，第三个是EntityId
